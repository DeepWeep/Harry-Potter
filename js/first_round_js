'use strict';

let handHarry = document.getElementById ('hand');
let torsoHarry = document.getElementById ('hero');
let enemyTom = document.getElementById ('tom');
let enemiesSecond = document.getElementById ('drago');
let elixirTom = document.getElementById ('potion_tom');
let elixirSecond = document.getElementById ('potion_drago');
let beamHarryToSecond = document.getElementById ('beamwand_harry_to_drago');
let beamHarryToTom = document.getElementById ('beamwand_harry_to_tom');
let beamTomToHero = document.getElementById ('beamwand_tom_to_hero');
let beamSecondToHero = document.getElementById ('beamwand_drago_to_hero');
let shotTom = document.getElementById ('shottom');
let shotSecond = document.getElementById ('shotdrago');

let tomObject = {
    energy: 1,
    fireToHarry: function () {
        if (tomObject.energy <= 0 || harry.energy <= 0) {
            clearInterval (tomFireToHarry);
        };
        beamTomToHero.style.display = 'block';
        shotTom.play();
        setTimeout (() => {beamTomToHero.style.display = 'none';},300);
        if (torsoHarry.style.display !== 'block') {
            harry.energy -= 0.1;
            handHarry.style.opacity = harry.energy;
        };
    }
};

let secondEnemyObject = {
    energy: 1,
    fireToHarry: function () {
        if (secondEnemyObject.energy <= 0 || harry.energy <= 0) {
            clearInterval (secondFireToHarry);
        };
        beamSecondToHero.style.display = 'block';
        shotSecond.play();
        setTimeout (() => {beamSecondToHero.style.display = 'none';},300); 
        if (torsoHarry.style.display !== 'block') {
            harry.energy -= 0.1;
            handHarry.style.opacity = harry.energy;
        };   
    }
};

let harry = {
    energy: 1,
    defenseIn: function (event) {
        if (event.code === 'Space') {
        torsoHarry.style.display = 'block';
        };
        if (event.code === 'ArrowRight') {
            if (elixirSecond.style.display === 'block') {
                harry.energy = 1;
                elixirSecond.style.display = 'none'
                handHarry.style.opacity = harry.energy;
            };
        };
        if (event.code === 'ArrowLeft') {
            if (elixirTom.style.display === 'block') {
                harry.energy = 1;
                elixirTom.style.display = 'none'
                handHarry.style.opacity = harry.energy;
            };
        };
    },
    defenseOut: function (event) {
        if (event.code === 'Space') {
            torsoHarry.style.display = 'none';
        };
    },
    fireIn: function (event) {
        event.preventDefault ();
        document.getElementById ('shotharry').play ();
        if (event.button === 0) {
            beamHarryToTom.style.display = 'block';
            tomObject.energy -= 0.25;
            if (tomObject.energy > 0) {
                document.getElementById ('woundtom').play ();
            };
            enemyTom.style.opacity = tomObject.energy;
            if (tomObject.energy === 0) {
                document.getElementById ('deadtom').play ();
                elixirTom.style.display = 'block';
            };
        };
        if (event.button === 2) {
            beamHarryToSecond.style.display = 'block';
            secondEnemyObject.energy -= 0.25;
            if (secondEnemyObject.energy > 0) {
                document.getElementById ('wounddrago').play ();
            };
            enemiesSecond.style.opacity = secondEnemyObject.energy;
            if (secondEnemyObject.energy === 0) {
                document.getElementById ('deaddrago').play ();
                elixirSecond.style.display = 'block';
            };
        };
    },
    fireOut: function (event) {
        event.preventDefault (); 
        if (event.button === 0) {
            beamHarryToTom.style.display = 'none';
        };
        if (event.button === 2) {
            beamHarryToSecond.style.display = 'none';
        };
    }
};

let tomFireToHarry = setInterval (tomObject.fireToHarry,3500);
let secondFireToHarry = setInterval (secondEnemyObject.fireToHarry,4500);

document.addEventListener ('keydown',harry.defenseIn);
document.addEventListener ('keyup',harry.defenseOut);
document.body.addEventListener ('mousedown',harry.fireIn);
document.body.addEventListener ('mouseup',harry.fireOut);

